<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post YouTube URLs</title>
</head>
<body>
    <h1>Post YouTube URLs</h1>

    <p>Enter a YouTube URL to post:</p>
    
    <form id="postForm">
        <label for="urlInput">YouTube URL:</label>
        <input type="text" id="urlInput" name="urls" placeholder="Enter youtube url">
        <!-- Add url to a li -->
        <button type="button" id="addUrlButton">Add URL</button>

        <!-- Added urls -->
        <ul id="urlList"></ul>

        <!-- Submit and download files -->

        <button type="submit">Submit</button>
    </form>

    <script>
        // Get the form element
        const form = document.querySelector('#postForm');
        const urlList = document.querySelector('#urlList');
        const addUrlButton = document.querySelector('#addUrlButton');
        const urlInput = document.querySelector('#urlInput');

        // Add an event listener for the form's submit event
        form.addEventListener('submit', async (event) => {
            // Prevent the default form submission behavior
            event.preventDefault();

            // Get the values of the input fields
            const urls = Array.from(document.querySelectorAll('#urlList li')).map(li => li.textContent);

            // Make a POST request to the server with the JSON payload
            const response = await fetch('http://127.0.0.1:5000/post_youtube_url', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ urls: urls })
            });

            // Get the response data as JSON
            const responseData = await response.json();

            // Log the response data to the console
            console.log(responseData);

            // Clear the input fields and the URL list
            urlInput.value = '';
            urlList.innerHTML = '';
        });

        // Add an event listener for the add URL button's click event
        addUrlButton.addEventListener('click', (event) => {
            // Prevent the default button click behavior
            event.preventDefault();

            // Get the value of the input field
            const url = urlInput.value;

            // Create a new list item element with the URL
            const li = document.createElement('li');
            li.textContent = url;

            // Add the list item to the URL list
            urlList.appendChild(li);

            // Clear the input field
            urlInput.value = '';
        });
    </script>
</body>
</html>
